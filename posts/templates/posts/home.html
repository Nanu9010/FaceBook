{% extends 'core/base.html' %}

{% block title %}Home{% endblock %}

{% block content %}
<h2>Latest Posts</h2>
{% for post in posts %}
<div class="post-card">
    <div class="post-header">
        <strong>{{ post.author.username }}</strong>
        <span class="timestamp">{{ post.created_at|date:"M d, Y H:i" }}</span>
    </div>
    <div class="post-content">
        <p>{{ post.content }}</p>
        {% if post.image %}
            <img src="{{ post.image.url }}" alt="Post image" class="post-img">
        {% endif %}
    </div>

    <div class="post-actions">
        <form method="POST" action="{% url 'add_comment' post.id %}">
            {% csrf_token %}
            <input type="text" name="text" placeholder="Add a comment..." required>
            <button type="submit" class="btn btn-primary">Comment</button>
        </form>
    </div>

    <div class="post-comments">
        {% for comment in post.comments.all %}
            <p><strong>{{ comment.user.username }}</strong> {{ comment.text }}</p>
        {% empty %}
            <p>No comments yet.</p>
        {% endfor %}
    </div>
</div>
{% empty %}
<p>No posts yet. <a href="{% url 'create_post' %}">Create one</a></p>
{% endfor %}
{% endblock %}
